!function(){"use strict";var e,t={9972:function(e,t,i){var n;i.d(t,{s:function(){return n}}),function(e){e.Section="SECTION",e.Widget="WIDGET"}(n||(n={}))},5588:function(e,t,i){var n=i(3316),o=i(5380),r=i(5312),a=i(3868);(0,n.U)((({popup:e})=>({filterPhrase:e.filterPhrase,showFilter:e.popupType===r.HH.AddWidget})),(()=>({applyFilter:o.cr})))(a.c)},5064:function(e,t,i){var n=i(3316),o=i(8700),r=i(4612),a=i(5312),s=i(6552);(0,n.U)((e=>{var t;const i=(({editableAreasConfiguration:e,metadata:t,popup:i,widgetZonesConfiguration:n})=>{const r=e[i.areaIdentifier],a=n[i.zoneIdentifier];return(0,o.c)(i.popupType,t,r,a)})(e),{popup:n}=e,s=n.popupType===a.HH.AddWidget&&null!==(t=n.recentWidgets)&&void 0!==t?t:[];return{recentItems:s,columnType:n.columnType,showComponent:n.popupType===a.HH.AddWidget&&i.length>r.Yn&&s.length>0}}))(s.c)},2440:function(e,t,i){var n=i(3316),o=i(100),r=i(5380),a=i(5312),s=i(4364);t.c=(0,n.U)((({popup:e},{sectionIdentifier:t})=>({isSectionListOpen:e.componentIdentifier===t&&e.popupType===a.HH.AddSection})),(()=>({closePopup:o.Sq,openPopup:(e,t,i)=>(0,r._Q)(e,a.HH.AddSection,t,i),setPopupPosition:o.Om})))(s.c)},7780:function(e,t,i){i.d(t,{A$:function(){return s},GQ:function(){return a},gT:function(){return r},ym:function(){return o}});var n=i(7820);const o=(e,t)=>{const i=Object.values(t);return null===e?i:e.length?i.filter((t=>d(e,t.typeIdentifier))):[]},r=(e,t)=>null===e||!!e.length&&d(e,t),a=(e,t)=>e&&n._k.contains(e,t),s=(e,t)=>null===e||null===t?null!=e?e:t:null==e?void 0:e.filter((e=>d(t,e))),d=(e,t)=>e.some((e=>n.sj.equalsIgnoreCase(e,t)))},696:function(e,t,i){i.d(t,{G:function(){return r},Gk:function(){return a}});const n=Object.prototype.hasOwnProperty,o=(e,t)=>e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t,r=(e,t)=>{if(o(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(let r=0;r<i.length;r++)if(!n.call(t,i[r])||!o(e[i[r]],t[i[r]]))return!1;return!0},a=e=>Array.isArray(e)?e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:{type:null}})),{}):e},7820:function(e,t,i){i.d(t,{Qv:function(){return l},SM:function(){return c},_k:function(){return d},sL:function(){return p},sj:function(){return s},sz:function(){return u},wd:function(){return a}});var n=i(7540),o=i(5312),r=i(655);const a={isEmpty(e){return e.constructor===Object&&0===Object.keys(e).length},assignDefined(e,...t){for(const i of t)for(const t of Object.keys(i)){const n=i[t];void 0!==n&&(e[t]=n)}return e}},s={format(e,...t){let i=e;return t.forEach(((e,t)=>{i=i.replace(new RegExp("\\{"+t+"\\}","g"),e)})),i},equalsIgnoreCase(e,t){return 0===e.localeCompare(t,void 0,{sensitivity:"base"})}},d={insertItemIntoArray(e,t,i){return i>e.length||i<0?e:[...e.slice(0,i),t,...e.slice(i)]},replaceItem:(e,t,i)=>!e.length||i>e.length||i<0?e:[...e.slice(0,i),t,...e.slice(i+1)],removeItem:(e,t)=>t>e.length||t<0?e:[...e.slice(0,t),...e.slice(t+1)],moveItemBetweenArrays:(e,t,i,n=null)=>{const o=null===n?e.length-1:n.length;if(i<0||i>o)throw new RangeError("The [position] argument is invalid.");if(!d.contains(e,t))throw new Error("The [item] was not found in [sourceArray].");const r=e.filter((e=>e!==t));return null===n?{sourceArray:d.insertItemIntoArray(r,t,i),destinationArray:null}:{sourceArray:r,destinationArray:d.insertItemIntoArray(n,t,i)}},getUniqueValues:(e,t=(e=>e))=>[...new Set(e.map(t))],contains:(e,t)=>e.indexOf(t)>=0,move:(e,t,i)=>(e.splice(i,0,e.splice(t,1)[0]),e),swap:(e,t,i)=>{const[n,o]=t>i?[i,t]:[t,i];return[...e.slice(0,n),e[o],...e.slice(n+1,o),e[n],...e.slice(o+1)]},toRecord:(e,t)=>e.reduce(((e,i)=>(e[i[t]]=i,e)),{})},l={dispatchEvent:(e,t)=>{const i=new CustomEvent(e,{detail:t});document.dispatchEvent(i)},getEventPath:e=>{let t=[],i=e.target;if(e.path)t=e.path;else for(;i;)t.push(i),i=i.parentElement;return t.filter((e=>e instanceof Node))}},c={removeSectionFromDragAndDrop:e=>{l.dispatchEvent(n.MJ,{sectionIdentifier:e})},mountSectionToDragAndDropAfterNextTick:async(e,t)=>{await e.$nextTick((()=>{c.mountSectionToDragAndDrop(t)}))},mountSectionToDragAndDrop:e=>{l.dispatchEvent(n.ik,{sectionIdentifier:e})}},u={disableDocumentLinks:()=>{const e=document.getElementsByTagName("a"),t=e.length;for(let i=0;i<t;i++)e[i].onclick=()=>!1},disableElementLinks:e=>{const t=e.getElementsByTagName("a"),i=t.length;let n;for(let e=0;e<i;e++)n=t[e],n.closest("div[data-inline-editor]")||(n.onclick=()=>!1)}},p={getTheme:e=>{switch(e){case o.HH.AddWidget:case o.HH.Personalization:return r.So.Widget;case o.HH.AddSection:case o.HH.ChangeSection:return r.So.Section}},isFriendlyElementSelected:(e,t)=>l.getEventPath(e).some((e=>t.some((t=>{const i=document.querySelector(t);return i&&(i===e||i.contains(e))})))),doesElementOrAncestor(e,t,i){let n=e;for(;n;){if(i(n))return!0;if(t&&t===n)break;n=n.parentElement}return!1}}},8700:function(e,t,i){i.d(t,{A:function(){return d},c:function(){return s}});var n=i(6012),o=i(7780),r=i(5312),a=i(655);const s=(e,t,i,s)=>{var d;if(![r.HH.AddWidget,r.HH.AddSection].includes(e))return[];const l=(0,n.Km)(a.UH.PopUpElementsService),c=e===r.HH.AddWidget,u=c?t.widgets:t.sections,p=c?(0,o.A$)(i.widgetRestrictions,null!==(d=null==s?void 0:s.widgetRestrictions)&&void 0!==d?d:null):i.sectionRestrictions,f=(0,o.ym)(p,u);return c?l.getWidgetElements(f):l.getSectionElements(f)},d=(e,t)=>{if(!t)return e;const i=t.toLowerCase();return e.filter((e=>e.name.toLowerCase().includes(i)))}},1220:function(e,t,i){i.d(t,{Oc:function(){return o},Qn:function(){return r},kX:function(){return c},se:function(){return a}});var n=i(5312);const o={Pixel:"pixel",Percent:"percent"},r=(e,t,i=o.Pixel)=>{const r=d(e),a=s(t,i)/2;return r.left<a?n.GG.Right:r.right<a?n.GG.Left:n.GG.Center},a=e=>e.top>window.innerHeight/2?n._4.Top:n._4.Bottom,s=(e,t)=>t===o.Percent?e:l(null!=e?e:(e=>{const t=document.body.querySelector("kentico-pop-up-container");return t&&t.offsetWidth?t.offsetWidth:e})(e)),d=e=>({left:l(e.left),right:l(window.innerWidth-e.right)}),l=e=>e/window.innerWidth,c=e=>({left:e.left+e.width/2+pageXOffset,top:a(e)===n._4.Top?e.top-10+pageYOffset:e.top+e.height+10+pageYOffset})},4612:function(e,t,i){i.d(t,{_S:function(){return r},Yn:function(){return o},my:function(){return a}});const n="ktc.pagebuilder.recentwidgets",o=4,r=4,a=()=>{var e;return null!==(e=(e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):void 0})(n))&&void 0!==e?e:[]}},8628:function(e,t,i){i.d(t,{a:function(){return c}});var n=i(3160),o=i.n(n),r=i(2620),a=i(9560),s=i(280),d=i(4152);let l=!1;const c=(e,t,i,n,l,c)=>(0,r.S)((()=>{if(!e)return;n&&(0,d.O)(),p(e);const r=n?u(e):{},f=(0,a.K)(i,t,r),g=(0,s.D)(f,t,r,l);c&&c(g),new(o())(e,g)})),u=e=>{const t=e.dataset.richTextEditorConfiguration,{richTextEditor:i}=window.kentico.pageBuilder,n=i&&i.configurations&&i.configurations[t];return"object"==typeof n?n:{}},p=e=>{if(l)return;const{enableImageRecognition:t,getLinkMetadataEndpointUrl:i,richTextEditorLicense:o,contextMacros:r,getImageDescriptionEndpointUrl:a}=e.dataset,s="true"===t.toLowerCase();Object.assign(n.DEFAULTS,{getLinkMetadataEndpointUrl:i,licenseKey:o,getImageDescriptionEndpointUrl:a,isImageRecognitionEnabled:s},r?{contextMacros:JSON.parse(r)}:{}),l=!0}},9764:function(e,t,i){i.d(t,{R:function(){return a}});var n=i(3160),o=i.n(n);i(8724),i(8628),i(7160);var r=i(4152);const a=()=>{o().MAIL_REGEX=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/;const e=n.DEFAULTS.videoInsertButtons||[];delete e[e.indexOf("videoUpload")],(0,r.k)()}},7160:function(e,t,i){i.d(t,{AZ:function(){return g},e2:function(){return m},mY:function(){return h},ot:function(){return v}});var n=i(8976),o=i.n(n),r=i(3368),a=i.n(r),s=i(8152),d=i(1204),l=i(7828);const c=/<input [^>]*data-macro-type="(query|pattern)[^>]*>/g,u=/data-macro-value="([^"]*)"/,p=/data-macro-default-value="([^"]*)"/,f=/{%\s*ResolveDynamicText\(\s*"(query|pattern)"\s*,\s*"([^"]+)"\s*,\s*"(.*?)"\s*\)\s*%}/g,g=e=>e.replace(c,((e,t)=>`{% ResolveDynamicText("${t}", "${e.match(u)[1]||""}", "${a()(e.match(p)[1]).replace(/"/g,'\\"')}") %}`)),m=(e,t)=>e.replace(f,((e,i,n,r)=>(0,l.uO)(i,n,o()(r.replace(/\\"/g,'"')),(0,d.K)(t,n)))),v=e=>e.replace(f,""),h=e=>{e.el.querySelectorAll(`.${s.Km}`).forEach((t=>{t.onclick=()=>e.kenticoMacroPlugin.showActionsPopup(t),t.onmousedown=e=>{2===e.button&&e.stopPropagation()}}))}},8724:function(e,t,i){i.d(t,{ID:function(){return d},QB:function(){return l},Qb:function(){return s},Qj:function(){return c}});var n=i(6012),o=i(2632),r=i(655);const a={},s=(e,t)=>{const i=e.querySelectorAll("[data-inline-editor]"),s=(0,n.Km)(r.UH.LocalizationService),d={cultureCode:s.getCultureCode(),getString:s.getLocalizationWithoutPrefix};for(const e of i){const i=e.dataset.inlineEditor,n=a[i];if(!n){const e=s.getLocalization("inlineeditors.notregistered",i);o.Q.logError(e);continue}const r=e.dataset.propertyName;if(r&&r.length)try{n.init({editor:e,propertyName:r,localizationService:d,propertyValue:t[r]})}catch(e){o.Q.logException(e)}else{const e=s.getLocalization("inlineeditors.missingpropertyname",i);o.Q.logError(e)}}},d=e=>{u(e,"dragStart")},l=e=>{u(e,"drop")},c=e=>{u(e,"destroy")},u=(e,t)=>{const i=e.querySelectorAll("[data-inline-editor]");for(const e of i){const i=e.dataset.inlineEditor,n=a[i];if(n.hasOwnProperty(t)){const i=n[t],o={editor:e};i.call(i,o)}}}},844:function(e,t,i){i.d(t,{KE:function(){return h},Kq:function(){return I},OM:function(){return m},cv:function(){return g},kf:function(){return f},m2:function(){return p},sv:function(){return v}});var n=i(9907),o=i.n(n),r=i(4236),a=i(7820),s=i(655),d=i(1396),l=i(7808),c=i(5492);const u=[],p=(e,t=[],i=0)=>(n,o,{localizationService:r})=>{y(e);const{title:a,url:s,data:d,theme:p,width:f,maximized:g,showFooter:m,applyButtonText:v,cancelButtonText:h}=w(e,r);u.push({applyCallback:e.applyCallback,cancelCallback:e.cancelCallback||(()=>null)});n((0,new l.O(b).openModalDialog)({componentIdentifier:`CustomDialog${u.length}`,dialogType:c.S.Custom,dialogTitle:a,dialogMarkupUrl:s,dialogTabs:t,activeTabIndex:i,dialogMarkupModel:d,dialogTheme:p,dialogWidth:f,maximized:g,showFooter:m,applyButtonText:v,cancelButtonText:h}))},f=e=>(t,i)=>{const n=i().modalDialogs.dialogs.length-1;t(d.K2(n,e))},g=(e,t=v)=>async(i,n,{logger:o})=>{try{const o=await u[u.length-1].applyCallback(e);if(o&&!1===o.closeDialog)return;const r=n().modalDialogs.dialogs.length-1;i(t(r)),u.pop()}catch(e){o.logException(e)}},m=(e,t=v)=>async(i,n,{logger:o})=>{try{await u[u.length-1].cancelCallback(e)}catch(e){o.logException(e)}finally{const e=n().modalDialogs.dialogs.length-1;i(t(e)),u.pop()}},v=e=>(t,i,{messaging:n})=>{n.postMessage(s.MX.CLOSE_MODAL_DIALOG,null,"*"),t(d.sv(e))},h=()=>(e,t)=>{const i=t().modalDialogs.dialogs;return i.length<=0||i[i.length-1].type!==c.S.Custom?null:o()(i[i.length-1].model)},y=e=>{if(!e.url||!e.applyCallback)throw new TypeError("Passed options do not have required properties.");if("function"!=typeof e.applyCallback)throw new TypeError("applyCallback is not an instance of a Function type.");if(e.cancelCallback&&"function"!=typeof e.cancelCallback)throw new TypeError("cancelCallback is not an instance of a Function type.");if("string"!=typeof e.url)throw new TypeError("url is not of the type string.");if(e.title&&"string"!=typeof e.title)throw new TypeError("title is not of the type string.");if(e.theme&&-1===Object.values(s.So).indexOf(e.theme))throw new TypeError("theme does not match any of the existing dialog themes.");if(void 0!==e.width&&("string"!=typeof e.width||!e.width.endsWith("px")&&!e.width.endsWith("%")))throw new TypeError("width must be represented by 'XXXpx' or 'XX%' string values.");if(void 0!==e.maximized&&"boolean"!=typeof e.maximized)throw new TypeError("maximized must be of type boolean.");if(void 0!==e.showFooter&&"boolean"!=typeof e.showFooter)throw new TypeError("showFooter must be of type boolean.")},w=(e,t)=>{const i={showFooter:!0,width:"66%",maximized:!1,applyButtonText:t.getLocalization("modaldialog.buttons.apply"),cancelButtonText:t.getLocalization("modaldialog.buttons.cancel")};return a.wd.assignDefined(i,e)},b=e=>({title:e.dialogTitle,markupUrl:e.dialogMarkupUrl,model:e.dialogMarkupModel,theme:e.dialogTheme}),I=(e,t,i)=>async(n,o,{logger:a})=>{try{const o=await(0,r.M)(t,i);n(d.oR(e,o))}catch(e){a.logException(e)}}},2392:function(e,t,i){i.d(t,{_Q:function(){return l},cr:function(){return u}});var n=i(7540),o=i(8700),r=i(1220),a=i(4612),s=i(100),d=i(5312);const l=(e,t,i,n=null,a=null,l=0)=>(u,p)=>{const f=(0,r.kX)(i);let g,m=d.GG.Center,v=d._4.Bottom,h=d.a_.Single,y=0;if([d.HH.AddSection,d.HH.AddWidget].includes(t)){const{metadata:s,editableAreasConfiguration:u,widgetZonesConfiguration:f,zones:w,editableAreas:b}=p(),I=(0,o.c)(t,s,u[n],f[a]);[g,h]=c(I.length+l,t),m=(0,r.Qn)(i,g,r.Oc.Percent),v=(0,r.se)(i),y=t===d.HH.AddWidget?e!==a?w[a].widgets.indexOf(e):0:b[n].sections.indexOf(e)}u((0,s._Q)(e,m,v,t,f,n,a,h,y))},c=(e,t)=>{switch(!0){case e<=5:return[n.cB,d.a_.Single];case e<=12||t===d.HH.AddSection:return[n.uw,d.a_.Double];case e>12:return[n.OC,d.a_.Quadruple]}},u=e=>(t,i)=>{const{editableAreasConfiguration:n,metadata:r,popup:a,widgetZonesConfiguration:d}=i();let l=p(n,d,r,a.areaIdentifier,a.zoneIdentifier);e&&(l=(0,o.A)(l,e)),t((0,s.wP)(l)),t((0,s.cr)(e))},p=(e,t,i,n,r)=>{const s=(0,a.my)();if(!s.length)return[];const l=e[n],c=t[r],u=(0,o.c)(d.HH.AddWidget,i,l,c),p=new Map(u.map((e=>[e.key,e]))),f=s.map((e=>p.get(e))).filter((e=>e));return f.splice(a._S),f}},4212:function(e,t,i){i.d(t,{OQ:function(){return m},Y$:function(){return g},kv:function(){return c}});var n=i(8016),o=i.n(n),r=i(2550),a=i(1332),s=i(3332),d=i(8196),l=i(6636);const c=async(e,t,i)=>{const n=(0,l.Yh)(t.sections[e].zones,t.zones),o=u(n,t);0!==o.length&&await p(o,t,i)},u=(e,t)=>{const i=e=>t.markups.variants[e].isDirty,n=e.reduce(((e,n)=>{const o=t.widgets[n].type,r=t.widgets[n].variants.filter(i);return 0===r.length?e:void 0===e[o]?Object.assign(Object.assign({},e),{[o]:r}):Object.assign(Object.assign({},e),{[o]:[...e[o],...r]})}),{});return Object.entries(n)},p=async(e,t,i)=>{const n=f(e,t),r=await Promise.all(n),a=o()(e,(([e,t])=>t)).reduce(((e,t,i)=>(e[t]=r[i],e)),{});i((0,d.W)(a))},f=(e,t)=>o()(e,(([e,i])=>{const n=t.metadata.widgets[e].markupUrl;return i.map((e=>{const i=t.widgetVariants[e].properties;return a.Yr(n,i)}))})),g=async(e,t,i=null,n=null)=>{const o=e.metadata.sections[t];!0===o.hasProperties&&null===n&&(n=await a.t(o.defaultPropertiesUrl));const d=await a.Yr(o.markupUrl,n),l=(0,s.uq)(d),c={identifier:i||(0,r.c)(),type:t,properties:n,zones:[]},u=(0,s.M5)(l.markup);u.forEach((e=>c.zones.push(e.identifier)));const{markup:p,restrictions:f}=(0,s.c5)(l.markup,c.zones);return{section:c,markup:{markup:p},widgetZones:u,widgetRestrictions:f}},m=(e,t,i,n)=>{const o={source:e.zones.reduce(((e,t)=>(e[t]=n.zones[t].name,e)),{}),target:i.reduce(((e,{identifier:t,name:i})=>(e[t]=i,e)),{})};return(0,l.UR)(v(e.zones,o.source),v(t.zones,o.target),n.zones)},v=(e,t)=>e.map((e=>({identifier:e,name:t[e]})))},6280:function(e,t,i){i.d(t,{cL:function(){return u},od:function(){return l},uw:function(){return p},y0:function(){return c},yS:function(){return f}});var n=i(9576),o=i.n(n),r=i(6636),a=i(7820),s=i(1376),d=i(4212);const l=(e,t,i)=>async(n,o)=>{const{section:r,markup:a,widgetZones:l,widgetRestrictions:c}=await(0,d.Y$)(o(),e);n(s.od(r,t,i,a,l,c))},c=(e,t)=>async(i,n)=>{const l=n(),c=l.sections[e],u=(0,r.Yh)(c.zones,l.zones),p=Object.values(o()(l.widgets,u));if(1===l.editableAreas[t].sections.length){const{section:n,markup:o,widgetZones:r,widgetRestrictions:u}=await(0,d.Y$)(l,l.editableAreasConfiguration[t].defaultSection,e);i(s.cL(c,n,o,a._k.toRecord(r,"identifier"),u,p))}else i(s.y0(c,t,p))},u=(e,t)=>async(i,n)=>{const o=n(),r=o.sections[e],{section:a,markup:l,widgetZones:c,widgetRestrictions:u}=await(0,d.Y$)(o,t);await(0,d.kv)(e,o,i);const p=(0,d.OQ)(r,a,c,o);i(s.cL(r,a,l,p,u))},p=(e,t,i,n)=>async(o,r)=>{const a=r();if(await(0,d.kv)(e,a,o),1===a.editableAreas[t].sections.length){const{section:e,markup:i,widgetZones:n,widgetRestrictions:r}=await(0,d.Y$)(a,a.editableAreasConfiguration[t].defaultSection);o(s.od(e,t,0,i,n,r))}o(s.uw(e,t,i,n))},f=(e,t)=>async(i,n,o)=>{try{const o=n(),r=o.sections[e],{section:a,markup:l,widgetZones:c,widgetRestrictions:u}=await(0,d.Y$)(o,r.type,e,t);await(0,d.kv)(e,o,i);const p=(0,d.OQ)(r,a,c,o);i(s.cL(r,a,l,p,u))}catch(e){o.logger.logException(e)}}},5380:function(e,t,i){i.d(t,{sv:function(){return r.sv},Kq:function(){return r.Kq},_Q:function(){return n._Q},cr:function(){return n.cr},yS:function(){return a.yS},M9:function(){return o.M9}});i(1332),i(9968),i(8196);var n=i(2392),o=i(9168),r=i(844),a=i(6280)},5312:function(e,t,i){i.d(t,{GG:function(){return n},HH:function(){return r},S2:function(){return s.S},_4:function(){return o},a_:function(){return a}});var n,o,r,a,s=i(5492);!function(e){e.Center="center",e.Left="left",e.Right="right"}(n||(n={})),function(e){e.Top="top",e.Bottom="bottom"}(o||(o={})),function(e){e.AddWidget="addWidget",e.AddSection="addSection",e.ChangeSection="changeSection",e.Personalization="personalization"}(r||(r={})),function(e){e.Single="single",e.Double="double",e.Quadruple="quadruple"}(a||(a={}))},7719:function(e,t,i){i.d(t,{Am:function(){return s},Gw:function(){return o},qt:function(){return a},wb:function(){return r},wp:function(){return l},wx:function(){return d}});var n=i(8980);const o=(0,n.createAction)("widgetSelection/SELECT",(e=>({widgetIdentifier:e})))(),r=(0,n.createAction)("widgetSelection/UNSELECT")(),a=(0,n.createAction)("widgetSelection/FREEZE")(),s=(0,n.createAction)("widgetSelection/THAW")(),d=(0,n.createAction)("widgetSelection/DISABLE_CLICK_AWAY")(),l=(0,n.createAction)("widgetSelection/ENABLE_CLICK_AWAY")()},3360:function(e,t,i){i(8800);var n=i(6012),o=(i(5968),i(1e3)),r=i(4980),a=i(655),s=i(4468),d=i(8360),l=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let u=class extends d.a{constructor(){super("kentico.formbuilder")}};u=l([(0,s.q)(),c("design:paramtypes",[])],u);var p=i(5620);const f=new p.Oq.Entity("widgetVariants",{},{idAttribute:"identifier"}),g=new p.Oq.Entity("widgets",{variants:[f]},{idAttribute:"identifier"}),m=new p.Oq.Entity("zones",{widgets:[g]},{idAttribute:"identifier"}),v=new p.Oq.Entity("sections",{zones:[m]},{idAttribute:"identifier"}),h={editableAreas:[new p.Oq.Entity("editableAreas",{sections:[v]},{idAttribute:"identifier"})]};var y=i(904);var w=i(7820),b=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},I=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i};let C=class{normalizeConfiguration(e){this.renameZoneConfiguration(e,"formComponents","widgets");const t=(0,p.Cs)(e,h).entities;this.mergePropertiesFromVariantsToComponents(e,t);return w.wd.isEmpty(t)?{editableAreas:{},sections:{},zones:{},widgets:{},widgetVariants:{}}:t}denormalizeConfiguration(e){const t=(0,p.gH)({editableAreas:Object.keys(e.editableAreas)},h,e);return this.renameZoneConfiguration(t,"widgets","formComponents"),this.mergePropertiesFromComponentsToVariants(e,t),t}normalizeMetadata(e){const t=e.formComponents.map((e=>{const{identifier:t}=e,i=I(e,["identifier"]);return Object.assign(Object.assign({},i),{hasEditableProperties:!1,hasProperties:!0,propertiesFormMarkupUrl:null,typeIdentifier:e.identifier})})),i=(0,p.Cs)({sections:e.sections,widgets:t},y.Q).entities;return{widgets:i.widgets||{},sections:i.sections||{},pageTemplates:{},personalizationConditionTypes:{}}}renameZoneConfiguration(e,t,i){for(const n of e.editableAreas)for(const e of n.sections)for(const n of e.zones)n[i]=n[t],delete n[t]}mergePropertiesFromComponentsToVariants(e,t){for(const i of t.editableAreas)for(const t of i.sections)for(const i of t.zones)for(const t of i.formComponents)t.properties=e.widgetVariants[t.variants[0].identifier].properties,delete t.variants}mergePropertiesFromVariantsToComponents(e,t){for(const i of e.editableAreas)for(const e of i.sections)for(const i of e.zones)for(const e of i.widgets)t.widgetVariants=t.widgetVariants||{},t.widgetVariants[e.identifier]={identifier:e.identifier,name:e.identifier,properties:e.properties},t.widgets[e.identifier].variants=t.widgets[e.identifier].variants||[],Object.assign(t.widgets[e.identifier].variants,[e.identifier]),delete t.widgets[e.identifier].properties}};C=b([(0,s.q)()],C);var R=i(2972);const S="kenticoFormBuilderFreezeUI",k="kenticoFormBuilderUnfreezeUI",E="kenticoPropertiesStateChanged",A="kenticoValidationRuleStateChanged",V="kenticoFormBuilderCloseExpandedValidationRuleConfiguration",T="kenticoVisibilityConditionStateChanged",P="Kentico.UnknownSection";var z=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let M=class extends R.o{getSectionElements(e){return e=e.filter((e=>e.typeIdentifier!==P)),this.getWidgetElements(e)}};M=z([(0,s.q)()],M);var W=i(2632),O=i(3640),D=i(3332),x=i(3948);const F=(e,t)=>{document.dispatchEvent(new CustomEvent("kenticoRenderMarkup",{detail:{markup:t,targetElementId:e}}))},L=async e=>{try{return await e()}catch(e){throw W.Q.logException(e),e}};var j=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let _=class extends O.M{async getConfiguration(e){const t=await super.getConfiguration(e),i=(0,n.Km)(a.UH.LocalizationService),o=Object.values(t.markups.sections).some((e=>!e.markup));o&&W.Q.logError(i.getLocalization("error.sectionrender"));const r=Object.values(t.sections).some((e=>e.type===P));r&&(0,D.m6)("error.sectionconfig",[]);const s=await(async()=>{const e=x.sT.validationRuleMetadataEndpoint;return L((async()=>(await x.KY.get(e)).data))})();return Object.assign(Object.assign({},t),{validationRulesMetadata:s})}};_=j([(0,s.q)()],_);const N=new o.q({skipBaseClassChecks:!0});N.bind(a.UH.LocalizationService).to(u),N.bind(a.UH.NormalizerService).to(C),N.bind(a.UH.PageConfigurationService).to(_),N.bind(a.UH.PopUpElementsService).to(M),N.bind(a.UH.MessagingService).to(r.Y);var q=i(7336),Q=i(1284),U=i(3296),H=i(1148),B=i(3316),$=i(1220),K=i(100),G=i(5312),Y=i(4812),Z=i(9781),X=i(2440),J=i(6280),ee=i(8980);const te=(0,ee.createAction)("expandedValidationRuleIdentifier/EXPAND_VALIDATION_RULE",(e=>({validationRuleIdentifier:e})))(),ie=(0,ee.createAction)("newValidationRuleIdentifiers/NEW_VALIDATION_RULE_IDENTIFIER",((e,t)=>({identifierForNewValidationRule:e,widgetVariantIdentifier:t})))(),ne=(0,ee.createAction)("newValidationRuleIdentifiers/VALIDATION_RULE_ADDED",((e,t,i)=>({validationRuleIdentifier:e,identifierForNewValidationRule:t,widgetVariantIdentifier:i})))(),oe=(0,ee.createAction)("refreshPropertiesPanelsNotifier/REFRESH")(),re=(0,ee.createAction)("savingInProgress/SHOW_SAVING_MESSAGE")(),ae=(0,ee.createAction)("savingInProgress/SHOW_SAVED_MESSAGE")();var se=i(1332),de=i(3676);const le=[],ce=async(e,t,i)=>{e(re()),await(async e=>{let t,i;const n=le[le.length-1],o=new Promise(((e,n)=>{t=e,i=n}));if(le.push(o),n)try{await n}catch(e){}try{const i=await e();return t(),i}catch(e){return i(),Promise.reject(e)}finally{le.splice(0,1)}})((()=>L((async()=>(0,se.Cw)(t,i))))),(0,de.postMessage)(a.MX.CONFIGURATION_CHANGED,null,"*"),e(ae())},ue=(e,t,i)=>async(n,o,r)=>{try{w.Qv.dispatchEvent(S,{}),n(re()),await J.od(e,t,i)(n,o,r);const a=x.sT;await ce(n,o(),a.formIdentifier.toString()),w.Qv.dispatchEvent(k,{})}catch(e){r.logger.logException(e)}},pe=(e,t)=>async(i,n,o)=>{try{w.Qv.dispatchEvent(S,{}),i(re()),await J.y0(e,t)(i,n,o);const r=x.sT;await ce(i,n(),r.formIdentifier.toString()),w.Qv.dispatchEvent(k,{})}catch(e){o.logger.logException(e)}},fe=(e,t)=>async(i,n,o)=>{try{w.Qv.dispatchEvent(S,{}),i(re()),await J.cL(e,t)(i,n,o);const r=x.sT;await ce(i,n(),r.formIdentifier.toString()),w.Qv.dispatchEvent(k,{})}catch(e){o.logger.logException(e)}},ge=(e,t,i,n)=>async(o,r,a)=>{try{w.Qv.dispatchEvent(S,{}),o(re()),await J.uw(e,t,i,n)(o,r,a);const s=x.sT;await ce(o,r(),s.formIdentifier.toString()),w.Qv.dispatchEvent(k,{})}catch(e){a.logger.logException(e)}};var me=i(5208),ve=i(9168);const he=(e,t,i)=>async(n,o,r)=>{try{n((0,me.qt)()),n(re());const a=await ve.WG(e,t,i)(n,o,r),s=x.sT;return await ce(n,o(),s.formIdentifier.toString()),n(oe()),n((0,me.Am)()),a}catch(e){r.logger.logException(e)}},ye=(e,t,i,n)=>async(o,r,a)=>{try{await ve.YX(e,t,i,n)(o,r,a);const s=x.sT;await ce(o,r(),s.formIdentifier.toString()),o(oe())}catch(e){a.logger.logException(e)}},we=(e,t)=>async(i,n,o)=>{try{ve.CK(e,t)(i,n,o);const r=x.sT;await ce(i,n(),r.formIdentifier.toString()),i(oe())}catch(e){o.logger.logException(e)}},be=(e,t)=>async(i,n,o)=>{try{await ve.Oc(e,t)(i,n,o);const r=x.sT;await ce(i,n(),r.formIdentifier.toString()),i(oe())}catch(e){o.logger.logException(e)}};var Ie=i(3520);var Ce=(0,B.U)(((e,t)=>({sectionsInArea:e.editableAreas[t.identifier].sections,dragAndDrop:e.dragAndDrop})),(()=>({removeSection:pe,changeSection:fe})))(Ie.c),Re=i(7808);const Se=[".buttonTooltip","is-template-button",".icon","button-type"];var ke=(0,Q._M)({data(){return{changePropertiesIcon:a.ae.Properties,buttonType:a.i6.Properties}},computed:{localizedButtonTooltip(){return this.$_localizationService.getLocalization(this.buttonTooltip)}},methods:{onOpenPropertiesDialog(){this.openModalDialog({componentIdentifier:this.identifier,dialogType:G.S2.SectionProperties,showFooter:!0})}},props:{identifier:{required:!0,type:String},buttonTooltip:{required:!0,type:String},dialogType:{required:!0,type:String},isTemplateButton:{default:!1,type:Boolean},openModalDialog:{type:Function}}}),Ee=i(5772);var Ae=(0,Ee.c)(ke,[["render",function(e,t,i,n,o,r){return(0,Q.Wz)(),(0,Q.An)("div",null,[(0,Q.QD)("kentico-header-button",{".buttonTooltip":e.localizedButtonTooltip,"is-template-button":e.isTemplateButton,".icon":e.changePropertiesIcon,"button-type":e.buttonType,onClick:t[0]||(t[0]=(...t)=>e.onOpenPropertiesDialog&&e.onOpenPropertiesDialog(...t))},null,40,Se)])}]]);const Ve=(e,t,i)=>{const{componentIdentifier:n}=e,{metadata:o,sections:r}=t;let s;return s={title:o.sections[r[n].type].name,markupUrl:o.sections[r[n].type].propertiesFormMarkupUrl,model:r[n].properties,theme:a.So.Section},Object.assign(Object.assign({},s),{title:i.getLocalization("widgetproperties.header",s.title)})};var Te=(0,B.U)((()=>({})),(()=>({openModalDialog:new Re.O(Ve).openModalDialog})))(Ae);const Pe={key:0,class:"ktc-extra-header-buttons"};var ze=(0,Q._M)({__name:"SectionHeaderExtraButtons",props:{sectionIdentifier:{},showPropertiesButton:{type:Boolean}},setup(e){const t=(0,Q.qo)(a.i6.Properties),i=(0,Q.qo)(G.S2.SectionProperties);return(e,n)=>e.showPropertiesButton?((0,Q.Wz)(),(0,Q.An)("div",Pe,[(0,Q.K2)((0,Q.KV)(Te),{identifier:e.sectionIdentifier,dialogType:i.value,"button-type":t.value,buttonTooltip:"section.propertiesButtonTooltip"},null,8,["identifier","dialogType","button-type"])])):(0,Q.g1)("",!0)}});var Me=(0,B.U)(((e,t)=>{const i=e.sections[t.sectionIdentifier];return{showPropertiesButton:!!i&&e.metadata.sections[i.type].hasProperties}}))(ze),We=i(5072);var Oe=i(3628),De=i(9972);const xe=[".localizationService",".widgetTitle"];var Fe=(0,Q._M)({props:{widgetTitle:{required:!0,type:String},widgetIdentifier:{required:!0,type:String},activeItemIdentifier:{type:String},showWidgetHeader:{type:Boolean}}});var Le=(0,Ee.c)(Fe,[["render",function(e,t,i,n,o,r){return(0,Q.wt)(((0,Q.Wz)(),(0,Q.An)("kentico-widget-header",{class:"ktc-widget-header--top",".localizationService":e.$_localizationService,".widgetTitle":e.widgetTitle},null,40,xe)),[[Q.Ub,e.showWidgetHeader]])}],["__scopeId","data-v-a9f2fe56"]]);var je=(0,B.U)(((e,{widgetIdentifier:t})=>{const{widgetVariants:i,displayedWidgetVariants:n,widgetSelection:o,dragAndDrop:r,highlightedWidget:a}=e,s=i[n[t]];return{showWidgetHeader:(a===t||o.identifier===t)&&r.entity!==De.s.Widget,activeItemIdentifier:s?s.identifier:null}}))(Le),_e=i(2392),Ne=i(5948);var qe=(0,B.U)(((e,t)=>{const{dragAndDrop:i,widgets:n,popup:o,zones:r,sections:a}=e,{sectionIdentifier:s,zoneIndex:d}=t,l=a[s]?a[s].zones[d]:"";return{zoneIdentifier:l,dragAndDrop:i,zone:r[l],popup:o,widgetsInZone:r[l]?r[l].widgets.map((e=>n[e])):[]}}),(()=>({removeWidget:we,closePopup:me.Sq,openPopup:(e,t,i=null,n=null,o=0)=>(0,_e._Q)(e,G.HH.AddWidget,t,i,n,o)})))(Ne.c),Qe=(0,Q._M)({components:{WidgetZone:qe,WidgetHeader:je},props:Object.assign({},Oe.k)});var Ue=(0,Ee.c)(Qe,[["render",function(e,t,i,n,o,r){const a=(0,Q.E1)("WidgetHeader"),s=(0,Q.E1)("WidgetZone",!0);return(0,Q.Wz)(),(0,Q.Az)(s,{sectionIdentifier:e.sectionIdentifier,zoneIndex:e.zoneIndex,areaIdentifier:e.areaIdentifier},{widgetHeader:(0,Q.Ql)((({widgetTitle:e,widgetIdentifier:t})=>[(0,Q.K2)(a,{widgetTitle:e,widgetIdentifier:t},null,8,["widgetTitle","widgetIdentifier"])])),_:1},8,["sectionIdentifier","zoneIndex","areaIdentifier"])}]]);var He=(0,Q._M)({mixins:[We.u],created(){this.widgetZone=(0,Q.Md)(Ue)}});var Be=(0,Q._M)({__name:"EditableArea",props:{identifier:{}},setup(e){return(e,t)=>((0,Q.Wz)(),(0,Q.Az)((0,Q.KV)(Ce),{identifier:e.identifier},{sectionMarkup:(0,Q.Ql)((({sectionMarkup:t,sectionIdentifier:i})=>[(0,Q.K2)(He,{sectionMarkup:t,sectionIdentifier:i,areaIdentifier:e.identifier},null,8,["sectionMarkup","sectionIdentifier","areaIdentifier"])])),sectionHeaderExtraButtons:(0,Q.Ql)((({sectionIdentifier:e})=>[(0,Q.K2)((0,Q.KV)(Me),{sectionIdentifier:e},null,8,["sectionIdentifier"])])),sectionDivider:(0,Q.Ql)((({sectionIdentifier:e,areaIdentifier:t})=>[(0,Q.K2)((0,Q.KV)(X.c),{sectionIdentifier:e,areaIdentifier:t},null,8,["sectionIdentifier","areaIdentifier"])])),_:1},8,["identifier"]))}});const $e={class:"ktc-form-builder-properties-panel"};var Ke=i(2550);const Ge=["id"],Ye={class:"ktc-form-builder-tab-content-inner"},Ze={id:"form-builder-validation",style:{display:"block"}},Xe={class:"ktc-label-property ktc-Top"},Je={class:"ktc-control-label"},et={class:"ktc-field-property"},tt={class:"ktc-field-rule-designer"},it=["id"];const nt={class:"ktc-rule-designer-rules"},ot={key:1,class:"ktc-alert ktc-alert-info"},rt=(0,Q.QD)("span",{class:"ktc-alert-icon"},[(0,Q.QD)("i",{class:"icon-i-circle"}),(0,Q.QD)("span",{class:"ktc-sr-only"},"Info")],-1),at={class:"ktc-alert-label"};var st=i(240);const dt={class:"ktc-rule-row"},lt={class:"ktc-rule-actions"},ct=["title"],ut=(0,Q.QD)("i",{"aria-hidden":"true",class:"icon-bin"},null,-1),pt={class:"ktc-sr-only"};const ft={class:"ktc-rule-row ktc-edit-rule-row"},gt=["value"],mt={class:"ktc-rule-description"},vt=["id"];var ht=(0,Q._M)({data(){return{validationRulesWithMetadata:[],validationRuleInstanceIdentifier:"",renderRuleMarkupId:"",model:null}},created(){this.validationRuleInstanceIdentifier=this.editedValidationRuleConfiguration?this.editedValidationRuleConfiguration.validationRule.instanceIdentifier:this.newValidationRuleIdentifiers.filter((e=>e.widgetVariantIdentifier===this.widgetVariantIdentifier))[0].validationRuleIdentifier,this.renderRuleMarkupId=`jqueryLoaded-validationRuleConfigurationForm-${this.validationRuleInstanceIdentifier}`,this.validationRulesWithMetadata=this.validationRulesMetadata.map((e=>({metadata:e,validationRule:this.editedValidationRuleConfiguration&&w.sj.equalsIgnoreCase(this.editedValidationRuleConfiguration.identifier,e.identifier)?Object.assign({},this.editedValidationRuleConfiguration.validationRule):{instanceIdentifier:this.validationRuleInstanceIdentifier}}))),null!==this.editedValidationRuleConfiguration?this.model=this.validationRulesWithMetadata.filter((e=>w.sj.equalsIgnoreCase(e.metadata.identifier,this.editedValidationRuleConfiguration.identifier)))[0]:this.validationRulesMetadata.length>0&&(this.model=this.validationRulesWithMetadata[0])},props:{validationRulesMetadata:{default:[],type:Array},editedValidationRuleConfiguration:{default:null,type:Object},widgetVariantIdentifier:{required:!0,type:String},formFieldName:{required:!0,type:String},newValidationRuleIdentifiers:{type:Array},refreshPropertiesPanelsNotifier:{type:Boolean}},watch:{model:[{handler:"valueInSelectorChanged"}],refreshPropertiesPanelsNotifier:[{handler:"valueInSelectorChanged"}]},methods:{valueInSelectorChanged(){(async(e,t,i,n)=>{const o=x.sT.validationRuleMarkupEndpoint,r={formComponentInstanceIdentifier:e,formFieldName:n,validationRule:JSON.stringify(i),validationRuleIdentifier:t};return L((async()=>(await x.KY.post(o,r)).data))})(this.widgetVariantIdentifier,this.model.metadata.identifier,this.model.validationRule,this.formFieldName).then((e=>{F(this.renderRuleMarkupId,e)}))}}});var yt=(0,Ee.c)(ht,[["render",function(e,t,i,n,o,r){return(0,Q.Wz)(),(0,Q.An)("div",ft,[(0,Q.wt)((0,Q.QD)("select",{class:"ktc-form-control","onUpdate:modelValue":t[0]||(t[0]=t=>e.model=t)},[((0,Q.Wz)(!0),(0,Q.An)(Q.ae,null,(0,Q.mi)(e.validationRulesWithMetadata,(e=>((0,Q.Wz)(),(0,Q.An)("option",{key:e.metadata.identifier,value:e},(0,Q.WA)(e.metadata.name),9,gt)))),128))],512),[[Q.Ip,e.model]]),(0,Q.QD)("span",mt,(0,Q.WA)(e.model.metadata.description),1),(0,Q.QD)("div",{id:e.renderRuleMarkupId},null,8,vt)])}]]);var wt=(0,B.U)((e=>({refreshPropertiesPanelsNotifier:e.refreshPropertiesPanelsNotifier})))(yt),bt=(0,Q._M)({components:{ValidationRuleConfigurationForm:wt},data(){return{removeRuleLabel:(0,n.Km)(a.UH.LocalizationService).getLocalization("propertiespanel.validationtab.removerule")}},methods:{expandContent(){this.$emit("expandRule",this.validationRuleConfiguration.validationRule.instanceIdentifier)},remove(){this.$emit("removeRule",this.validationRuleConfiguration.validationRule.instanceIdentifier)}},props:{formFieldName:{required:!0,type:String},isExpanded:{default:!1,type:Boolean},widgetVariantIdentifier:{required:!0,type:String},validationRuleConfiguration:{required:!0,type:Object},validationRulesMetadata:{default:[],type:Array}}});var It=(0,Ee.c)(bt,[["render",function(e,t,i,n,o,r){const a=(0,Q.E1)("ValidationRuleConfigurationForm");return(0,Q.Wz)(),(0,Q.An)("div",null,[(0,Q.wt)((0,Q.QD)("div",dt,[(0,Q.QD)("span",{class:"ktc-rule-expandable-title",onClick:t[0]||(t[0]=(...t)=>e.expandContent&&e.expandContent(...t))},(0,Q.WA)(e.validationRuleConfiguration.validationRule.title),1),(0,Q.QD)("div",lt,[(0,Q.QD)("button",{type:"button",onClick:t[1]||(t[1]=(...t)=>e.remove&&e.remove(...t)),class:"ktc-remove-rule ktc-icon-only ktc-btn-icon ktc-btn",title:e.removeRuleLabel},[ut,(0,Q.QD)("span",pt,(0,Q.WA)(e.removeRuleLabel),1)],8,ct)])],512),[[Q.Ub,!e.isExpanded]]),e.isExpanded?((0,Q.Wz)(),(0,Q.Az)(a,{key:0,editedValidationRuleConfiguration:e.validationRuleConfiguration,validationRulesMetadata:e.validationRulesMetadata,widgetVariantIdentifier:e.widgetVariantIdentifier,formFieldName:e.formFieldName},null,8,["editedValidationRuleConfiguration","validationRulesMetadata","widgetVariantIdentifier","formFieldName"])):(0,Q.g1)("",!0)])}]]),Ct=(0,Q._M)({components:{ValidationRule:It,ValidationRuleConfigurationForm:wt},data(){return{localizationService:(0,n.Km)(a.UH.LocalizationService)}},computed:{isNewRuleExpanded(){const e=this.getWidgetVariantToNewValidationRuleBinding();return e&&this.expandedValidationRuleIdentifier===e.validationRuleIdentifier}},created(){this.createNewValidationRuleIdentifier((0,Ke.c)(),this.widgetVariantIdentifier)},methods:{newRuleExpand(){this.expandValidationRule(this.getWidgetVariantToNewValidationRuleBinding().validationRuleIdentifier)},expandRule(e){this.expandValidationRule(e)},async removeRule(e){await(0,st.G)(this.localizationService.getLocalization("propertiespanel.validationtab.confirmationmessage.removevalidationrule"))&&this.$emit("removeValidationRule",e,this.widgetVariantIdentifier)},getWidgetVariantToNewValidationRuleBinding(){return this.newValidationRuleIdentifiers.filter((e=>e.widgetVariantIdentifier===this.widgetVariantIdentifier))[0]}},props:{validationRuleConfigurations:{default:[],type:Array},formFieldName:{required:!0,type:String},widgetVariantIdentifier:{required:!0,type:String},validationRulesMetadata:{default:[],type:Array},expandedValidationRuleIdentifier:{default:"",type:String},newValidationRuleIdentifiers:{type:Array},expandValidationRule:{type:Function},createNewValidationRuleIdentifier:{type:Function},freezeWidgetSelection:{type:Function}}});var Rt=(0,Ee.c)(Ct,[["render",function(e,t,i,n,o,r){const a=(0,Q.E1)("ValidationRule"),s=(0,Q.E1)("ValidationRuleConfigurationForm");return(0,Q.Wz)(),(0,Q.An)("div",null,[(0,Q.QD)("div",nt,[((0,Q.Wz)(!0),(0,Q.An)(Q.ae,null,(0,Q.mi)(e.validationRuleConfigurations,(t=>((0,Q.Wz)(),(0,Q.Az)(a,{key:t.validationRule.instanceIdentifier,formFieldName:e.formFieldName,isExpanded:t.validationRule.instanceIdentifier===e.expandedValidationRuleIdentifier,validationRuleConfiguration:t,validationRulesMetadata:e.validationRulesMetadata,onExpandRule:e.expandRule,onRemoveRule:e.removeRule,widgetVariantIdentifier:e.widgetVariantIdentifier},null,8,["formFieldName","isExpanded","validationRuleConfiguration","validationRulesMetadata","onExpandRule","onRemoveRule","widgetVariantIdentifier"])))),128)),e.isNewRuleExpanded?((0,Q.Wz)(),(0,Q.Az)(s,{key:0,validationRulesMetadata:e.validationRulesMetadata,formFieldName:e.formFieldName,widgetVariantIdentifier:e.widgetVariantIdentifier,newValidationRuleIdentifiers:e.newValidationRuleIdentifiers},null,8,["validationRulesMetadata","formFieldName","widgetVariantIdentifier","newValidationRuleIdentifiers"])):(0,Q.g1)("",!0)]),e.validationRulesMetadata.length?((0,Q.Wz)(),(0,Q.An)("button",{key:0,onClick:t[0]||(t[0]=(...t)=>e.newRuleExpand&&e.newRuleExpand(...t)),class:"ktc-btn ktc-btn-default"},(0,Q.WA)(e.localizationService.getLocalization("propertiespanel.validationtab.addvalidationrule")),1)):(0,Q.g1)("",!0),e.validationRulesMetadata.length?(0,Q.g1)("",!0):((0,Q.Wz)(),(0,Q.An)("div",ot,[rt,(0,Q.QD)("div",at,(0,Q.WA)(e.localizationService.getLocalization("propertiespanel.validationtab.novalidationrules")),1)]))])}]]);var St=(0,B.U)((e=>({expandedValidationRuleIdentifier:e.expandedValidationRuleIdentifier,newValidationRuleIdentifiers:e.newValidationRuleIdentifiers})),(()=>({expandValidationRule:te,createNewValidationRuleIdentifier:ie,freezeWidgetSelection:me.qt})))(Rt);const kt={class:"ktc-form-builder-visibility-section"},Et=["id"];const At={class:"ktc-btn-group"},Vt=["onClick"],Tt={class:"ktc-tabs-details"};const Pt=(0,Q._M)({data(){return{tabs:[]}},methods:{selectTab(e){this.tabs.forEach((t=>{t.identifier===e.identifier?(this.onTabChange&&this.onTabChange(e),t.isActive=!0):t.isActive=!1}))}},props:{onTabChange:{type:Function}}});var zt=(0,Q._M)({mixins:[Pt]});var Mt=(0,Ee.c)(zt,[["render",function(e,t,i,n,o,r){return(0,Q.Wz)(),(0,Q.An)("div",null,[(0,Q.QD)("div",At,[((0,Q.Wz)(!0),(0,Q.An)(Q.ae,null,(0,Q.mi)(e.tabs,(t=>((0,Q.Wz)(),(0,Q.An)("button",{key:t.identifier,type:"button",class:(0,Q.WN)(["ktc-btn ktc-btn-default",{"ktc-active":t.isActive}]),onClick:i=>e.selectTab(t)},(0,Q.WA)(t.getLocalizedString()),11,Vt)))),128))]),(0,Q.QD)("div",Tt,[(0,Q.oF)(e.$slots,"default")])])}]]);var Wt=(0,Q._M)({data(){return{isActive:!1}},mounted(){this.isActive=this.selected},methods:{getLocalizedString(){return(0,n.Km)(a.UH.LocalizationService).getLocalization(this.name)}},created(){this.$parent.tabs.push(this)},props:{identifier:{required:!0,type:String},name:{required:!0,type:String},selected:{default:!1,type:Boolean}}});var Ot=(0,Ee.c)(Wt,[["render",function(e,t,i,n,o,r){return(0,Q.wt)(((0,Q.Wz)(),(0,Q.An)("div",null,[(0,Q.oF)(e.$slots,"default")],512)),[[Q.Ub,e.isActive]])}]]),Dt=(0,Q._M)({components:{Tab:Ot,ButtonGroupSelector:Mt},data(){return{renderConditionMarkupId:"",tabAlwaysIdentifier:"always",neverVisibleVisibilityCondition:"Kentico.NeverVisible"}},created(){this.renderConditionMarkupId=`jqueryLoaded-visibilityCondition-${this.widgetVariantIdentifier}`},mounted(){this.refreshMarkup()},methods:{onTabChange(e){let t=null;if(e.identifier===this.tabAlwaysIdentifier)t={detail:{identifier:this.widgetVariantIdentifier,visibilityConditionConfiguration:null}};else{if(e.identifier!==this.neverVisibleVisibilityCondition)return void this.$nextTick(this.refreshMarkup);t={detail:{identifier:this.widgetVariantIdentifier,visibilityConditionConfiguration:{identifier:this.neverVisibleVisibilityCondition,visibilityCondition:{}}}}}document.dispatchEvent(new CustomEvent(T,t))},async refreshMarkup(){if(this.$refs.conditionTab.isActive){const e=await(async(e,t)=>{const i=x.sT.visibilityConditionMarkupEndpoint,n={formComponentInstanceIdentifier:e,formFieldName:t};return L((async()=>(await x.KY.post(i,n)).data))})(this.widgetVariantIdentifier,this.formFieldName);F(this.renderConditionMarkupId,e)}}},props:{widgetVariantIdentifier:{required:!0,type:String},visibilityConditionConfiguration:{type:Object||null},formFieldName:{required:!0,type:String},refreshPropertiesPanelsNotifier:{type:Boolean}},watch:{refreshPropertiesPanelsNotifier:[{handler:"refreshMarkup"}]}});var xt=(0,Ee.c)(Dt,[["render",function(e,t,i,n,o,r){const a=(0,Q.E1)("Tab"),s=(0,Q.E1)("ButtonGroupSelector");return(0,Q.Wz)(),(0,Q.An)("div",kt,[(0,Q.K2)(s,{onTabChange:e.onTabChange},{default:(0,Q.Ql)((()=>[(0,Q.K2)(a,{identifier:e.tabAlwaysIdentifier,name:"propertiespanel.visibilityconditions.tab.always",selected:null==e.visibilityConditionConfiguration},null,8,["identifier","selected"]),(0,Q.K2)(a,{identifier:e.neverVisibleVisibilityCondition,name:"propertiespanel.visibilityconditions.tab.never",selected:e.visibilityConditionConfiguration&&e.visibilityConditionConfiguration.identifier==e.neverVisibleVisibilityCondition},null,8,["identifier","selected"]),(0,Q.K2)(a,{identifier:"condition",ref:"conditionTab",name:"propertiespanel.visibilityconditions.tab.condition",selected:e.visibilityConditionConfiguration&&e.visibilityConditionConfiguration.identifier!=e.neverVisibleVisibilityCondition},{default:(0,Q.Ql)((()=>[(0,Q.QD)("div",{id:e.renderConditionMarkupId},null,8,Et)])),_:1},8,["selected"])])),_:1},8,["onTabChange"])])}]]);var Ft=(0,B.U)((e=>({refreshPropertiesPanelsNotifier:e.refreshPropertiesPanelsNotifier})))(xt);const Lt={class:"ktc-form-builder-tabs"},jt={class:"ktc-form-builder-tabs-nav"},_t=["onClick"],Nt={class:"ktc-form-builder-tab-content"},qt={class:"ktc-form-builder-tab-content-container"};var Qt=(0,Q._M)({mixins:[Pt]});var Ut=(0,Ee.c)(Qt,[["render",function(e,t,i,n,o,r){return(0,Q.Wz)(),(0,Q.An)("div",Lt,[(0,Q.QD)("div",jt,[((0,Q.Wz)(!0),(0,Q.An)(Q.ae,null,(0,Q.mi)(e.tabs,(t=>((0,Q.Wz)(),(0,Q.An)("a",{key:t.identifier,class:(0,Q.WN)(["ktc-form-builder-tab-link",{"ktc-active":t.isActive}]),onClick:i=>e.selectTab(t)},(0,Q.WA)(t.getLocalizedString()),11,_t)))),128))]),(0,Q.QD)("div",Nt,[(0,Q.QD)("div",qt,[(0,Q.oF)(e.$slots,"default")])])])}]]),Ht=(0,Q._M)({components:{ValidationRules:St,Tab:Ot,Tabs:Ut,VisibilityConditionEditorForm:Ft},computed:{propertiesTabIdentifier(){return`jqueryLoaded-propertiesTab-${this.widgetProperties.guid}`},validationTabIdentifier(){return`jqueryLoaded-validationTab-${this.widgetProperties.guid}`}},mounted(){this.renderPropertiesEditor()},methods:{removeValidationRule(e,t){this.$emit("removeValidationRule",e,t)},renderPropertiesEditor(){(async e=>{const t=x.sT.propertiesEditorEndpoint;return L((async()=>(await x.KY.post(t,e)).data))})({identifier:this.widgetIdentifier,type:this.widgetType,properties:this.widgetProperties}).then((e=>{F(this.propertiesTabIdentifier,e),this.$emit("contentLoaded",{identifier:this.widgetIdentifier})}))}},props:{widgetIdentifier:{required:!0,type:String},widgetType:{required:!0,type:String},widgetProperties:{required:!0,type:Object},validationRulesMetadata:{default:()=>[],type:Array},refreshPropertiesPanelsNotifier:{type:Boolean}},watch:{refreshPropertiesPanelsNotifier:[{handler:"renderPropertiesEditor"}]}});var Bt=(0,Ee.c)(Ht,[["render",function(e,t,i,n,o,r){const a=(0,Q.E1)("Tab"),s=(0,Q.E1)("ValidationRules"),d=(0,Q.E1)("VisibilityConditionEditorForm"),l=(0,Q.E1)("Tabs");return(0,Q.Wz)(),(0,Q.Az)(l,null,{default:(0,Q.Ql)((()=>[(0,Q.K2)(a,{identifier:"propertiesTab",name:"propertiespanel.propertiestab.name",selected:!0},{default:(0,Q.Ql)((()=>[(0,Q.QD)("div",{id:e.propertiesTabIdentifier},null,8,Ge)])),_:1}),(0,Q.K2)(a,{identifier:"validationTab",name:"propertiespanel.validationtab.name",selected:!1},{default:(0,Q.Ql)((()=>[(0,Q.QD)("div",Ye,[(0,Q.QD)("div",Ze,[(0,Q.QD)("div",Xe,[(0,Q.QD)("span",Je,(0,Q.WA)(e.$_localizationService.getLocalization("propertiespanel.validationtab.rules")),1)]),(0,Q.QD)("div",et,[(0,Q.QD)("span",tt,[(0,Q.K2)(s,{validationRuleConfigurations:e.widgetProperties.validationRuleConfigurations,validationRulesMetadata:e.validationRulesMetadata,formFieldName:e.widgetProperties.name,widgetVariantIdentifier:e.widgetProperties.guid,onRemoveValidationRule:e.removeValidationRule},null,8,["validationRuleConfigurations","validationRulesMetadata","formFieldName","widgetVariantIdentifier","onRemoveValidationRule"])])])]),(0,Q.QD)("div",{id:e.validationTabIdentifier},null,8,it)])])),_:1}),(0,Q.K2)(a,{identifier:"visibilityTab",name:"propertiespanel.visibilitytab.name"},{default:(0,Q.Ql)((()=>[(0,Q.K2)(d,{formFieldName:e.widgetProperties.name,widgetVariantIdentifier:e.widgetProperties.guid,visibilityConditionConfiguration:e.widgetProperties.visibilityConditionConfiguration,class:"ktc-form-builder-tab-content-inner"},null,8,["formFieldName","widgetVariantIdentifier","visibilityConditionConfiguration"])])),_:1})])),_:1})}]]);var $t=(0,B.U)((e=>({refreshPropertiesPanelsNotifier:e.refreshPropertiesPanelsNotifier})))(Bt),Kt=(0,Q._M)({components:{PropertiesEditorForm:$t},data(){return{requestedWidgetIdentifier:null,displayedWidgetIdentifier:null,markupsLoaded:[]}},computed:{wigdetsWithRequestedOrLoadedPropertiesMarkup(){return Object.values(this.widgets).filter((e=>e.identifier===this.requestedWidgetIdentifier||this.markupsLoaded[e.identifier]))}},mounted(){document.addEventListener(S,this.freezeWidgetSelectionEventCallback),document.addEventListener(E,this.propertiesStateChangedEventCallback),document.addEventListener(A,this.validationRuleStateChangedEventCallback),document.addEventListener(k,this.thawWidgetSelectionEventCallback),document.addEventListener(V,this.closeValidationRule),document.addEventListener(T,this.visibilityConditionChangedEventCallback)},beforeUnmount(){document.removeEventListener(S,this.freezeWidgetSelectionEventCallback),document.removeEventListener(E,this.propertiesStateChangedEventCallback),document.removeEventListener(A,this.validationRuleStateChangedEventCallback),document.removeEventListener(k,this.thawWidgetSelectionEventCallback),document.removeEventListener(V,this.closeValidationRule),document.removeEventListener(T,this.visibilityConditionChangedEventCallback)},methods:{onMouseDown(){this.disableWidgetClickAway()},freezeWidgetSelectionEventCallback(){this.freezeWidgetSelection()},async propertiesStateChangedEventCallback(e){const t=this.getWidgetVariant(e.detail.identifier),i=this.getWidget(t.identifier),n=Object.assign(Object.assign({},t.properties),e.detail.properties);await this.setWidgetProperties(i.identifier,n),this.thawWidgetSelection()},async visibilityConditionChangedEventCallback(e){const t=e.detail.identifier,i=e.detail.visibilityConditionConfiguration,n=this.getWidgetVariant(t),o=this.getWidget(n.identifier),r=Object.assign({},n.properties);r.visibilityConditionConfiguration=i;const a=Object.assign({},r);await this.setWidgetProperties(o.identifier,a),this.thawWidgetSelection()},async validationRuleStateChangedEventCallback(e){const t=e.detail.identifier,i=e.detail.validationRuleConfiguration,n=i.validationRule,o=this.getWidgetVariant(t),r=this.getWidget(o.identifier),a=Object.assign({},o.properties),s=a.validationRuleConfigurations;let d=s.filter((e=>e.validationRule.instanceIdentifier===n.instanceIdentifier))[0],l=null;d?(d=Object.assign(Object.assign({},d),i),l=[...s.map((e=>e.validationRule.instanceIdentifier!==d.validationRule.instanceIdentifier?e:d))],this.closeValidationRule()):(l=[...s,i],this.newValidationRuleAdded(i.validationRule.instanceIdentifier,(0,Ke.c)(),t)),a.validationRuleConfigurations=l;const c=Object.assign({},a);await this.setWidgetProperties(r.identifier,c),this.thawWidgetSelection()},async removeValidationRule(e,t){const i=this.getWidgetVariant(t),n=this.getWidget(i.identifier),o=Object.assign({},i.properties),r=o.validationRuleConfigurations.filter((t=>t.validationRule.instanceIdentifier!==e));o.validationRuleConfigurations=r;const a=Object.assign({},o);await this.setWidgetProperties(n.identifier,a)},closeValidationRule(){this.expandValidationRule(null)},getWidgetVariant(e){return Object.values(this.widgetVariants).filter((t=>t.properties.guid===e))[0]},getWidget(e){return Object.values(this.widgets).filter((t=>t.variants[0]===e))[0]},thawWidgetSelectionEventCallback(){this.thawWidgetSelection()},getWidgetProperties(e){return this.widgetVariants[e.variants[0]].properties},getCompatibleValidationRulesMetadata(e){const t=this.widgetMetadata[e.type];return this.validationRulesMetadataPerType[t.valueType]},propertiesEditorFormContentLoaded(e){this.markupsLoaded[e.identifier]=!0,this.requestedWidgetIdentifier===e.identifier&&(this.displayedWidgetIdentifier=e.identifier)},loadPropertiesEditor(){if(this.savingInProgress)return;const e=this.widgets[this.widgetSelection.identifier];e&&"Kentico.Invalid"!==e.type?(this.requestedWidgetIdentifier=this.widgetSelection.identifier,this.markupsLoaded[this.requestedWidgetIdentifier]&&(this.displayedWidgetIdentifier=this.requestedWidgetIdentifier),this.widgetSelection.identifier||(this.displayedWidgetIdentifier=null)):this.displayedWidgetIdentifier=null}},props:{widgetVariants:{type:Object},widgets:{type:Object},widgetSelection:{type:Object},validationRulesMetadataPerType:{type:Object},widgetMetadata:{type:Object},savingInProgress:{type:Boolean},freezeWidgetSelection:{type:Function},setWidgetProperties:{type:Function},thawWidgetSelection:{type:Function},newValidationRuleAdded:{type:Function},expandValidationRule:{type:Function},disableWidgetClickAway:{type:Function}},watch:{"widgetSelection.identifier":[{handler:"loadPropertiesEditor"}],savingInProgress:[{handler:"loadPropertiesEditor"}]}});const Gt=(0,Ee.c)(Kt,[["render",function(e,t,i,n,o,r){const a=(0,Q.E1)("PropertiesEditorForm");return(0,Q.Wz)(),(0,Q.An)("div",$e,[((0,Q.Wz)(!0),(0,Q.An)(Q.ae,null,(0,Q.mi)(e.wigdetsWithRequestedOrLoadedPropertiesMarkup,(t=>(0,Q.wt)(((0,Q.Wz)(),(0,Q.Az)(a,{key:t.identifier,widgetIdentifier:t.identifier,widgetType:t.type,widgetProperties:e.getWidgetProperties(t),validationRulesMetadata:e.getCompatibleValidationRulesMetadata(t),onMousedown:e.onMouseDown,onContentLoaded:e.propertiesEditorFormContentLoaded,onRemoveValidationRule:e.removeValidationRule},null,8,["widgetIdentifier","widgetType","widgetProperties","validationRulesMetadata","onMousedown","onContentLoaded","onRemoveValidationRule"])),[[Q.Ub,t.identifier===e.displayedWidgetIdentifier&&e.markupsLoaded[t.identifier]]]))),128)),e.displayedWidgetIdentifier?(0,Q.g1)("",!0):(0,Q.oF)(e.$slots,"default",{key:0})])}]]);var Yt=Gt;var Zt=(0,B.U)((e=>({validationRulesMetadataPerType:e.validationRulesMetadata,widgetMetadata:e.metadata.widgets,widgetVariants:e.widgetVariants,widgets:e.widgets,widgetSelection:e.widgetSelection,savingInProgress:e.savingInProgress})),(()=>({expandValidationRule:te,freezeWidgetSelection:me.qt,newValidationRuleAdded:ne,setWidgetProperties:be,thawWidgetSelection:me.Am,disableWidgetClickAway:me.wx})))(Yt);var Xt=(0,Q._M)({data(){return{timeoutID:null,showMessage:!1}},props:{savingInProgress:{type:Boolean},fadeOutDuration:{default:2e3,type:Number}},watch:{savingInProgress:[{handler:"onSave"}]},methods:{onSave(e){this.showMessage=!0,e?e&&this.timeoutID&&(window.clearTimeout(this.timeoutID),this.timeoutID=null):this.timeoutID=window.setTimeout((()=>{this.showMessage=!1}),this.fadeOutDuration)}}});var Jt=(0,Ee.c)(Xt,[["render",function(e,t,i,n,o,r){return(0,Q.wt)(((0,Q.Wz)(),(0,Q.An)("div",null,[e.savingInProgress?(0,Q.oF)(e.$slots,"saving",{key:0}):(0,Q.g1)("",!0),e.savingInProgress?(0,Q.g1)("",!0):(0,Q.oF)(e.$slots,"saved",{key:1})],512)),[[Q.Ub,e.showMessage]])}]]);var ei=(0,B.U)((e=>({savingInProgress:e.savingInProgress})))(Jt),ti=i(7316);class ii extends ti.i{constructor(e,t,i,n,o,r,a,s,d,l,c,u){super(a,s,d,l,c,u,null),this.formIdentifier=e,this.propertiesEditorEndpoint=t,this.validationRuleMetadataEndpoint=i,this.validationRuleMarkupEndpoint=n,this.visibilityConditionMarkupEndpoint=o,this.saveMessageClientId=r}validate(){if(0===this.formIdentifier)throw new Error((0,n.Km)(a.UH.LocalizationService).getLocalization("notinitialized"))}getComponentMarkupData(e){return{postedData:e,formIdentifier:this.formIdentifier}}}var ni=i(9176),oi=i(3303),ri=i(1044),ai=i(1316),si=i(6300),di=i(2364),li=i(3056);const ci=(0,ni.TL)(Object.assign(Object.assign({},li.R),{config:(e=null)=>e,expandedValidationRuleIdentifier:(e=null,t)=>{switch(t.type){case(0,ee.getType)(te):return t.payload.validationRuleIdentifier;case(0,ee.getType)(ne):return null;default:return e}},newValidationRuleIdentifiers:(e=[],t)=>{switch(t.type){case(0,ee.getType)(ie):return[...e.filter((e=>e.widgetVariantIdentifier!==t.payload.widgetVariantIdentifier)),{validationRuleIdentifier:t.payload.identifierForNewValidationRule,widgetVariantIdentifier:t.payload.widgetVariantIdentifier}];case(0,ee.getType)(ne):return[...e.filter((e=>e.validationRuleIdentifier!==t.payload.validationRuleIdentifier)),{validationRuleIdentifier:t.payload.identifierForNewValidationRule,widgetVariantIdentifier:t.payload.widgetVariantIdentifier}];default:return e}},refreshPropertiesPanelsNotifier:(e=null,t)=>t.type===(0,ee.getType)(oe)?!e:e,savingInProgress:(e=null,t)=>{switch(t.type){case(0,ee.getType)(re):return!0;case(0,ee.getType)(ae):return!1;default:return e}},validationRulesMetadata:(e={})=>e})),ui=(e,t)=>{const i=(0,ai.m)(t);return(0,ni.eC)(ci,e,i((0,ni.d4)(oi.c.withExtraArgument((0,ri.w)()),di.m,si.g)))};var pi=i(4540),fi=i(5836);var gi=(0,B.U)((({modalDialogs:e,popup:t})=>({modalDialogs:e.dialogs.filter((e=>e.type===G.S2.Custom)),popupType:t.popupType})),(()=>({selectItem:new fi.y(he,ue).selectItem})))(pi.c),mi=i(5380),vi=i(7540);const hi=["id",".configuration",".messages",".isModified"],yi=[".localizationService",".formMarkup",".componentName",".isValid",".theme",".openedDialogsCount"];var wi=i(1460);var bi=(0,Q._M)({data(){return{$refs:undefined,dialogIndex:0,formChanged:!1}},computed:{dialogConfiguration(){return{title:this.componentName,showFooter:!0,applyButtonText:this.$_localizationService.getLocalization("widgetproperties.apply"),cancelButtonText:this.$_localizationService.getLocalization("widgetproperties.cancel"),tabs:null,theme:this.dialogTheme,showLoader:!1,dialogIndex:this.dialogIndex,openedDialogsCount:this.dialogsCount,width:"600px",maximized:!1,setPosition:!1}},modalDialogStyles(){return this.dialogsCount>1?{}:{top:0,left:0,bottom:0,right:0,position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10200}},dialogMessages(){return{unsavedChanges:this.$_localizationService.getLocalization("modalDialog.close.confirmation"),loaderMessage:this.$_localizationService.getLocalization("modaldialogs.loading"),closeTooltip:this.$_localizationService.getLocalization("typelist.closeTooltip")}}},async mounted(){(0,wi.g)(document),await this.fetchMarkup(this.dialogIndex,this.propertiesFormUrl,this.properties)},beforeUnmount(){0===this.dialogIndex&&(0,wi.Q)(document)},methods:{async onSubmitPropertiesForm(e){await this.submitDialogForm(this.dialogIndex,e.detail.configurationForm.getAttribute("action"),this.properties,e.detail.formData)},onFormChange(){this.formChanged=!0},onDialogClose(){this.closeDialog(this.dialogIndex)},async onDialogApply(){await this.$refs.propertiesForm.validateProperties()}},props:{formMarkup:{type:String},properties:{type:Object},propertiesFormUrl:{type:String},componentName:{type:String},formIsValid:{type:Boolean},dialogId:{type:String},dialogTheme:{type:String},dialogsCount:{type:Number},closeDialog:{type:Function},fetchMarkup:{type:Function},submitDialogForm:{type:Function}}});var Ii=(0,Ee.c)(bi,[["render",function(e,t,i,n,o,r){return(0,Q.Wz)(),(0,Q.An)("kentico-modal-dialog",{id:e.dialogId,".configuration":e.dialogConfiguration,".messages":e.dialogMessages,".isModified":e.formChanged,style:(0,Q.c$)(e.modalDialogStyles),onApply:t[2]||(t[2]=(...t)=>e.onDialogApply&&e.onDialogApply(...t)),onClose:t[3]||(t[3]=(...t)=>e.onDialogClose&&e.onDialogClose(...t))},[(0,Q.QD)("kentico-properties-form",{ref:"propertiesForm",".localizationService":e.$_localizationService,".formMarkup":e.formMarkup,".componentName":e.componentName,".isValid":e.formIsValid,".theme":e.dialogTheme,".openedDialogsCount":e.dialogsCount,"on:submitPropertiesForm":t[0]||(t[0]=(...t)=>e.onSubmitPropertiesForm&&e.onSubmitPropertiesForm(...t)),"on:formChange":t[1]||(t[1]=(...t)=>e.onFormChange&&e.onFormChange(...t))},null,40,yi)],44,hi)}]]),Ci=i(44),Ri=i.n(Ci),Si=i(1396),ki=i(4236);class Ei{constructor(e){this.setSectionPropertiesThunk=e,this.submitPropertiesDialogForm=(e,t,i,n)=>async(o,r,a)=>{try{const a=await(0,ki.t)(t,n);if(this.isFormValid(a)){const{modalDialogs:t}=r(),n=t.dialogs[e],s=Object.assign({},i,a.data.properties);if(!Ri()(i,s)){const e=this.setSectionPropertiesThunk;await o(e(n.identifier,s));const t=x.sT;await ce(o,r(),t.formIdentifier.toString())}o((0,mi.sv)(e))}else o((0,Si.Yj)(e)),o((0,Si.oR)(e,a.data))}catch(e){a.logger.logException(e)}},this.isFormValid=e=>"valid"===e.status}}var Ai=(0,B.U)((e=>{const{modalDialogs:t}=e,i=t.dialogs[0];if(!i)return null;const{type:n,markup:o,isValid:r,title:a,markupUrl:s,model:d}=i;return{componentName:a,dialogId:vi.WO,dialogType:n,dialogTheme:t.theme,formMarkup:o,properties:d,propertiesFormUrl:s,formIsValid:r,dialogsCount:t.dialogs.length}}),(()=>({closeDialog:mi.sv,fetchMarkup:mi.Kq,submitDialogForm:new Ei(mi.yS).submitPropertiesDialogForm})))(Ii);var Vi=(0,Q._M)({__name:"FormBuilderGlobalComponentWrapper",props:{showPropertiesDialog:{type:Boolean}},setup(e){return(e,t)=>((0,Q.Wz)(),(0,Q.Az)((0,Q.KV)(gi),null,{default:(0,Q.Ql)((()=>[e.showPropertiesDialog?((0,Q.Wz)(),(0,Q.Az)((0,Q.KV)(Ai),{key:0})):(0,Q.g1)("",!0)])),_:1}))}});var Ti=(0,B.U)((({modalDialogs:e})=>({showPropertiesDialog:!!e.dialogs.length&&e.dialogs[0].type!==G.S2.Custom})))(Vi),Pi=i(9368),zi=i(9928),Mi=i(6276),Wi=i(8152);const Oi=e=>{e&&e.toolbarButtons&&Di(e)},Di=e=>{const t=[zi.aU],i=[Mi.yY,Mi.gp],n=[Mi.IH,Mi.ek,Wi.eG,Mi.Qj];if(Array.isArray(e.imageEditButtons)&&(e.imageEditButtons=e.imageEditButtons.filter((e=>!t.includes(e)))),Array.isArray(e.quickInsertButtons)&&(e.quickInsertButtons=e.quickInsertButtons.filter((e=>!i.includes(e)))),Array.isArray(e.toolbarButtons))e.toolbarButtons=e.toolbarButtons.filter((e=>!n.includes(e)));else if((0,Pi.i)(e.toolbarButtons))for(const t of Object.values(e.toolbarButtons))t&&t.buttons&&(t.buttons=t.buttons.filter((e=>!n.includes(e))))};var xi,Fi,Li,ji=function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},_i=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ni=function(e,t){return function(i,n){t(i,n,e)}};let qi=class extends U.E{constructor(e,t,i){super(e,t,i)}async initializeFormBuilder(e){const t=new ii(e.formIdentifier,e.propertiesEditorEndpoint,e.validationRuleMetadataEndpoint,e.validationRuleMarkupEndpoint,e.visibilityConditionMarkupEndpoint,e.saveMessageClientId,e.applicationPath,e.configurationEndpoints,e.metadataEndpoint,e.allowedOrigins,e.propertiesEditorClientId,e.constants),i=await super.initialize(t,(t=>ui(t,e.developmentMode)),Ti,Be,ye,ge),n=(0,B.a)(i);this.initializePropertiesEditor(n,t),this.initializeSaveMessage(n,t),this.registerFormScrollListener(i),document.addEventListener(Z.W,(({target:t,detail:i})=>{(0,Y.q)(t,i,Oi,e.htmlSanitizer,!1)}))}initializePropertiesEditor(e,t){const i=(0,Q.W0)({components:{PropertiesEditor:Zt},el:`#${t.propertiesEditorClientId}`,mixins:[e]});i.config.globalProperties.$_localizationService=this.localizationService,i.mount(`#${t.propertiesEditorClientId}`)}initializeSaveMessage(e,t){const i=(0,Q.W0)({components:{SaveMessage:ei},el:`#${t.saveMessageClientId}`,mixins:[e]});i.config.globalProperties.$_localizationService=this.localizationService,i.mount(`#${t.saveMessageClientId}`)}registerFormScrollListener(e){const t=document.body.querySelector(".ktc-form-builder-mvc-form");t.addEventListener("scroll",(()=>{const{popup:i}=e.getState(),n=(null==i?void 0:i.popupType)===G.HH.AddWidget?t.querySelector("kentico-add-component-button[is-active]"):(null==i?void 0:i.popupType)===G.HH.AddSection?t.querySelector("kentico-section-divider[active]").shadowRoot.querySelector("kentico-add-component-button[is-active]"):null;if(n){const t=(0,$.kX)(n.getBoundingClientRect()),o=(0,$.se)(n.getBoundingClientRect());e.dispatch((0,K.Om)(i.horizontalPosition,o,t))}}))}};qi=ji([(0,s.q)(),Ni(0,(0,q.u)(a.UH.LocalizationService)),Ni(1,(0,q.u)(a.UH.PageConfigurationService)),Ni(2,(0,q.u)(a.UH.MessagingService)),_i("design:paramtypes",["function"==typeof(xi=void 0!==H.LocalizationService&&H.LocalizationService)?xi:Object,"function"==typeof(Fi=void 0!==O.M&&O.M)?Fi:Object,"function"==typeof(Li=void 0!==r.Y&&r.Y)?Li:Object])],qi),(0,n.u2)(N),window.kentico=window.kentico||{},window.kentico.formBuilder={init:async e=>{const t=(0,n.Yz)(qi);await t.initializeFormBuilder(e)}}}},i={};function n(e){var o=i[e];if(void 0!==o)return o.exports;var r=i[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=t,e=[],n.O=function(t,i,o,r){if(!i){var a=1/0;for(c=0;c<e.length;c++){i=e[c][0],o=e[c][1],r=e[c][2];for(var s=!0,d=0;d<i.length;d++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](i[d])}))?i.splice(d--,1):(s=!1,r<a&&(a=r));if(s){e.splice(c--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[i,o,r]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={318:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var o,r,a=i[0],s=i[1],d=i[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(d)var c=d(n)}for(t&&t(i);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},i=self.webpackChunkpage_builder=self.webpackChunkpage_builder||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var o=n.O(void 0,[275,984],(function(){return n(3360)}));o=n.O(o)}();